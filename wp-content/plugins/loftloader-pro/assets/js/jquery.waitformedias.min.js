!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(b){var w="undefined"==typeof loftloaderDetectElement?"all":loftloaderDetectElement;b.loftloaderProWaitForMedia={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage","cursor"],hasImageAttributes:["srcset"],hasIframeVideos:[/^.*(?:(?:youtu\.be\/|v\/|vi\/|u\/\w\/|embed\/)|(?:(?:watch)?\?v(?:i)?=|\&v(?:i)?=))([^#\&\?'"]*).*/,/https?:\/\/(?:www\.|player\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|album\/(\d+)\/video\/|video\/|)(\d+)/]},b.expr[":"]["has-src"]=function(e){return b(e).is('img[src][src!=""]')},b.expr[":"].uncached=function(e){return!!b(e).is(":has-src")&&!e.complete},b.fn.loftloaderProWaitForMedia=function(){var e,r,t,a=b(this).first(),i="all"===w,o=!1,s=!1,n=(b.Deferred(),5),c=5;function d(){o||(o=!0,e.call(a,n)),s&&(clearInterval(s),s=!1)}if(b.isPlainObject(arguments[0])&&(t=arguments[0].waitForAll,r=arguments[0].each,e=arguments[0].finished),e=e||b.noop,t=!!t,(r=r||b.noop).call(a,c),s=setInterval(function(){c<95?i?(n=c+=5,r.call(a,c)):5<=Math.abs(parseInt(c,10)-parseInt(n,10))&&(n=c,r.call(a,c)):(clearInterval(s),s=!1)},700),b(window).on("load",function(e){d()}),!i){var l=0,f=0,u=[],m=[],h=-1!==["video","media"].indexOf(w),p=-1!==["image","media"].indexOf(w),v=b.loftloaderProWaitForMedia.hasImageProperties||[],g=b.loftloaderProWaitForMedia.hasImageAttributes||[],I=/url\(\s*(['"]?)(.*?)\1\s*\)/g;function y(){f++,c=Math.floor(f/l*100),f===l&&d()}t&&(a=a.find("*").addBack()).not(b("#loftloader-wrapper").find("*").addBack()).each(function(){var i=b(this);if(p&&(i.is("img:has-src")&&!i.is("[srcset]")&&m.push({src:i.attr("src"),element:i[0]}),b.each(v,function(e,r){var t,a=i.css(r);if(!a)return!0;for(;t=I.exec(a);)m.push({src:t[2],element:i[0]})}),b.each(g,function(e,r){if(!i.attr(r))return!0;m.push({src:i.attr("src"),srcset:i.attr("srcset"),element:i[0]})})),h)if(i.is("iframe")){var t=i.attr("src"),e=b.loftloaderProWaitForMedia.hasIframeVideos||[];-1===u.indexOf(t)&&b.each(e,function(e,r){if(r.exec(t))return u.push(t),m.push({src:t,isMedia:!0,type:"iframe",element:i[0]}),!1})}else if(i.is("video")&&(i.attr("src")||i.find('[src!=""]').length)){var r=i.attr("src")?i.attr("src"):i.find('[src!=""]').attr("src");-1===u.indexOf(r)&&(u.push(r),m.push({src:r,isMedia:!0,type:"video",element:i[0]}))}}),0===(l=m.length)&&d(),b.each(m,function(e,r){if(r.isMedia)if("video"==r.type){var t=document.createElement("video");b(t).one("loadeddata",function(e){y()}),t.src=r.src}else b(r.element).one("load error",function(e){y()});else{var a=new Image;b(a).one("load  error",function(e){y()}),r.srcset&&(a.srcset=r.srcset),a.src=r.src}})}}});
